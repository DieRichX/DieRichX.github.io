<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Telegram Login</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
    }
    .container {
      background: white;
      color: #333;
      padding: 40px;
      border-radius: 15px;
      text-align: center;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    h1 {
      margin-bottom: 10px;
    }
    .subtitle {
      color: #666;
      margin-bottom: 30px;
    }
    .widget-container {
      margin: 30px 0;
      min-height: 50px;
    }
    .status {
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
      font-size: 14px;
    }
    .success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    .info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîê –í—Ö–æ–¥ –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</h1>
    <div class="subtitle">–ß–µ—Ä–µ–∑ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç Telegram</div>
    
    <div class="widget-container">
      <!-- –ò–°–ü–û–õ–¨–ó–£–ï–ú –ù–û–í–û–ì–û –ë–û–¢–ê -->
      <script async 
        src="https://telegram.org/js/telegram-widget.js?22" 
        data-telegram-login="YourMessengerAuthBot"
        data-size="large" 
        data-userpic="true"
        data-onauth="onTelegramAuth">
      </script>
    </div>

    <div id="status" class="status info">
      –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã –≤—Ö–æ–¥–∞ Telegram...
    </div>

    <button onclick="window.close()" style="
      background: #6c757d;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
    ">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>

  <script>
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Telegram
    function onTelegramAuth(user) {
      console.log('üîê –†–ï–ê–õ–¨–ù–´–ô –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Telegram:', user);
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—Ö
      const status = document.getElementById('status');
      status.className = 'status success';
      status.innerHTML = `
        <strong>‚úÖ –í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω!</strong><br>
        –ò–º—è: ${user.first_name}<br>
        Username: @${user.username || '–Ω–µ —É–∫–∞–∑–∞–Ω'}<br>
        ID: ${user.id}
      `;
      
      // –ü–µ—Ä–µ–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Electron –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ –≤ Electron)
      if (window.teleAuth && typeof window.teleAuth.send === 'function') {
        window.teleAuth.send(user);
      }
      
      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
      setTimeout(() => {
        if (window.teleAuth && typeof window.teleAuth.cancel === 'function') {
          window.teleAuth.cancel();
        } else {
          window.close();
        }
      }, 3000);
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É –≤–∏–¥–∂–µ—Ç–∞
    setTimeout(() => {
      const widget = document.querySelector('.tgme_widget');
      const status = document.getElementById('status');
      
      if (widget && widget.offsetParent !== null) {
        status.className = 'status success';
        status.innerHTML = '‚úÖ –ì–æ—Ç–æ–≤–æ! –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "Login with Telegram" –≤—ã—à–µ';
      } else {
        status.className = 'status error';
        status.innerHTML = `
          ‚ùå –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å<br><br>
          <strong>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:</strong><br>
          ‚Ä¢ –ë–æ—Ç: <strong>YourMessengerAuthBot</strong><br>
          ‚Ä¢ –î–æ–º–µ–Ω: <strong>dierichx.github.io</strong><br>
          ‚Ä¢ –°—Ç—Ä–∞–Ω–∏—Ü–∞: <strong>auth.html</strong>
        `;
      }
    }, 3000);

    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
    setTimeout(() => {
      const widget = document.querySelector('.tgme_widget');
      if (!widget) {
        console.log('Telegram widget still not loaded');
      }
    }, 5000);
    function closeWindow() {
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ localStorage –¥–ª—è Electron
      if (window.opener) {
        window.opener.postMessage('telegram-auth-complete', '*');
      }
      window.close();
    }

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
    setTimeout(closeWindow, 3000);
  </script>
</body>
</html>

