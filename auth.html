<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Telegram Login</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
    }
    .container {
      background: white;
      color: #333;
      padding: 40px;
      border-radius: 15px;
      text-align: center;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    .success { background: #d4edda; color: #155724; padding: 15px; border-radius: 8px; }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîê Telegram Login</h1>
    <div id="widgetContainer">
      <script async 
        src="https://telegram.org/js/telegram-widget.js?22" 
        data-telegram-login="YourMessengerAuthBot"
        data-size="large" 
        data-onauth="onTelegramAuth">
      </script>
    </div>
    <div id="status"></div>
  </div>

  <script>
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ö–æ–¥–∞
    function onTelegramAuth(user) {
      console.log('Telegram user:', user);
      
      // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
      localStorage.setItem('telegramAuthData', JSON.stringify(user));
      localStorage.setItem('telegramAuthTimestamp', Date.now());
      
      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å
      document.getElementById('status').className = 'success';
      document.getElementById('status').innerHTML = `
        <strong>‚úÖ –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥!</strong><br>
        –ò–º—è: ${user.first_name}<br>
        –ó–∞–∫—Ä–æ–π—Ç–µ —ç—Ç–æ –æ–∫–Ω–æ –∏ –≤–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
      `;
      
      // –ü—Ä—è—á–µ–º –≤–∏–¥–∂–µ—Ç
      document.getElementById('widgetContainer').style.display = 'none';
      
      // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
      setTimeout(() => {
        window.close();
      }, 5000);
    }

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–µ—Ç –¥–∞–Ω–Ω—ã–µ —É–∂–µ –≤ URL (—Ä–µ–¥irect –æ—Ç Telegram)
    function checkUrlForAuth() {
      const hash = window.location.hash;
      if (hash && hash.includes('tgAuth')) {
        console.log('Found auth data in URL');
        // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ URL
      }
    }

    // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É
    checkUrlForAuth();
  </script>
</body>
</html>
